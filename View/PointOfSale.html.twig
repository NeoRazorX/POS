{% extends 'Master/MenuTemplate.html.twig' %}
{% block bodyHeaderOptions %}
    {% set pageData = fsc.getPageData() %}
    <div class="container-fluid">
        <div class="row">
            <div class="col-4">
                <a class="btn btn-sm btn-outline-secondary" href="{{ fsc.url() }}">
                    <i class="fas fa-sync" aria-hidden="true"></i>
                </a>
            </div>
            <div class="col-4 text-center">
                {% if fsc.arqueo.abierto %}                    
                    <form id="formCloseCashCount" method="POST" autocomplete="off">
                        <input type="hidden" name="action" value="cerrararqueo">
                        <input type="hidden" name="idterminal" value="{{ fsc.arqueo.idterminal }}">                        
                        <button type="submit" class="btn btn-sm btn-danger">
                            <i class="fas fa-lock" aria-hidden="true"></i>&nbsp; Cerrar caja
                        </button>
                    </form>
                {% endif %}
            </div>
            <div class="col-4 text-right">
                <h1 class="h3">
                {{ fsc.title }} {{ fsc.terminal.nombre ? ' / '}} {{ fsc.terminal.nombre }}
                <i class="{{ pageData.icon }} fa-fw" aria-hidden="true"></i>
                </h1>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <hr/>
            </div>
        </div>
    </div>
{% endblock %}
{% block body %}
    {% if fsc.arqueo.abierto %}
        {{ include('Block/SalesScreen.html.twig') }}
    {% else %}
        <div class="container-fluid">
            {% if fsc.terminal.idterminal %}
                <form id="formInitCashCount" method="POST" autocomplete="off">
                    <input type="hidden" name="terminal" value="{{ fsc.terminal.idterminal }}">
                    <input type="hidden" name="action" value="iniciararqueo">
                    
                    <div class="card mx-auto w-50">
                        <div class="card-header bg-dark text-white text-center">{{ fsc.terminal.nombre }}</div>
                        <div class="card-body">
                            <p class="card-text">Selecciona un vendedor y el efectivo en caja para iniciar.</p>
                            <div class="form-group">
                                <select class="form-control" id="codagente" name="codagente">
                                    <option value="0"> --- </option>
                                    {% for agente in fsc.agente.all() %}
                                        <option value="{{ agente.codagente }}">{{ agente.nombre }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="form-row">
                                <div class="col">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fas fa-money-bill-alt"></i></span>
                                            </div>
                                            <input type="number" class="form-control" name="saldoinicial" placeholder="0">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col text left">
                                    <a href="{{ asset('PointOfSale') }}">Ver todas</a>
                                </div>
                                <div class="col text-right">
                                    <button class="btn btn-primary" type="submit">
                                    <span class="d-none d-sm-inline-block">Continuar</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            {% else %}
                <div class="row">
                    <div class="card mx-auto w-50">
                        <div class="card-header bg-dark text-white text-center">{{ i18n.trans('available-cash-registers') }}</div>
                        <div class="card-body">
                            <p class="card-text">Selecciona una terminal para comenzar.</p>
                            {% set terminals = fsc.terminal.allAvailable() %}
                            {% for terminal in terminals %}
                                <div class="row mb-2">
                                    <div class="col-12">
                                        <a href="{{ fsc.url()}}?terminal={{ terminal.idterminal }}" class="btn btn-primary btn-lg btn-block">{{ terminal.nombre }}</a>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
    {% endif %}
{% endblock %}